<%- include('../partials/mainheader.ejs')%>




<p id="msg4" class="text-danger" style="color: red;"></p>

    <div class="col-lg-9 col-md-8" style="margin-left: 14%; padding-top: 50px;">
        <div class="tab-content" id="myaccountContent" >
           

            <!-- Single Tab Content Start -->
            <div class="tab-pane fade show active" id="dashboad" role="tabpanel" >
                <div class="myaccount-content">
                    <h3>Add Your New Address</h3>
                    <div class="account-details-form">
                        <div  >
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="single-input-item">
                                        <label for="first-name" class="required">User Name</label>
                                        <input type="text" id="username" name="username" value="<%=  addressData.name %>" />
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="single-input-item">
                                        <label for="last-name" class="required">Mobile Number</label>
                                        <input type="number" id="usermobile" name="usermobile"
                                        value="<%=  addressData.mobile %>" />
                                    </div>
                                </div>
                            </div>
                            <fieldset>
                                <legend>Local Address</legend>
                                <div class="single-input-item">
                                    <label for="current-pwd" class="required">Address</label>
                                    <input type="text" id="address" name="address"
                                    value="<%=  addressData.address %>"/>
                                </div>
                                <div class="single-input-item">
                                    <label for="current-pwd" class="required">Street Address</label>
                                    <input type="text" id="streetaddress" name="streetaddress"
                                    value="<%=  addressData.streetaddress %>" />
                                </div>
                                <div class="row">
                                    <div class="col-lg-6">
                                        <div class="single-input-item">
                                            <label for="new-pwd" class="required">Pincode</label>
                                            <input type="number" id="pincode" name="pincode"
                                            value="<%=  addressData.pincode %>" />
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="single-input-item">
                                            <label for="confirm-pwd" class="required">City</label>
                                            <input type="text" id="city" name="city" value="<%=  addressData.city %>" />
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="single-input-item">
                                            <label for="new-pwd" class="required">State</label>
                                            <input type="text" id="state" name="state" value="<%=  addressData.state %>" />
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="single-input-item">
                                            <label for="confirm-pwd" class="required">Landmark</label>
                                            <input type="text" id="landmark" name="landmark"
                                            value="<%=  addressData.landmark %>" />
                                        </div>
                                    </div>

                                </div>
                            </fieldset>
                            <div class="single-input-item btn-hover">
                               
                                <button onclick="updateAddress('<%= addressData._id %>')"  class="check-btn sqr-btn">Add New Address</button>
                            
                            </div>
                        </div>
                    </div>
                </div>
            </div>





        </div>
    </div> <!-- My Account Tab Content End -->

    <!-- my account wrapper end -->
    <script>
        function updateAddress(id) {
           
          let username = document.getElementById("username").value;
    
    
          let usermobile = document.getElementById("usermobile").value;
     
          let address = document.getElementById("address").value;
      
          let streetaddress = document.getElementById("streetaddress").value;
     
          let pincode = document.getElementById("pincode").value;
      
          let state = document.getElementById("state").value;
    
          let landmark = document.getElementById("landmark").value;
       
          let city = document.getElementById("city").value;
    
          let message = document.getElementById("msg4");

          console.log(message)
        
        
      
      
          fetch(`/edituseraddress/${id}`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ username, usermobile,address,streetaddress,pincode,city,landmark,state}),
          })
            .then((response) => {
              if (!response.ok) {
                throw new Error("Network response was not ok");
              }
              return response.json();
            })
            .then((data) => {
                console.log("data : ",data);
              if (data.already) {
                console.log(data)
                
                message.innerHTML = data.already;
                // window.location.href = "/userprofile?msg=Address Changed Succesfully"
                
              } else if (data.success) {
                
                window.location.href = "/userprofile"
               
                
              } else {
                message.innerHTML = "Somthing wrong";
              }
            })
      
            .catch((err) => {
              console.log(err);
            });
        }
      </script>



    <%- include('../partials/mainfooter.ejs')%>